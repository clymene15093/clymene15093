
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="shortcut icon" type="image/x-icon" href="" />
    <link rel="icon" type="image/x-icon" href="" />
    <link rel="apple-touch-icon" type="image/x-icon" href="" />
    <meta content="" property="og:image:alt">
    <meta content="" property="og:title">
    <meta content="" property="og:site_name">
    <meta content="" name="copyright">
    <meta content="" name="description">
    <meta content="" property="og:description">
    <meta content="" property="og:image">
    <meta content="" property="og:image:secure_url">
    <meta content="website" property="og:type">


    <style>
      :root {--主題色: #54d6f4;--走馬燈文字色: #edff66;}
      * {margin: 0;padding: 0;box-sizing: border-box;font-family: "Microsoft JhengHei", Arial, sans-serif;}

      body{margin-top: -50px;}
      

      /* 走馬燈 */
      .marquee-container {height: 50px;width: 100%;position: relative;overflow: hidden;background: #343434;}
      .marquee-container:hover .marquee-content {animation-play-state: paused;}
      .marquee-content {position: absolute;width: 100%;display: flex;flex-direction: column;transition: transform 0.5s ease-in-out; /* 滑動時添加平滑效果 */}      
      .marquee-item {padding: 5px;text-align: center;  height: 50px;display: flex;align-items: center;justify-content: center;}
      .marquee-item a {text-decoration: none;color: var(--走馬燈文字色); }
      .marquee-item a:hover {text-decoration: underline;}
      .close-marquee {position: absolute;right: 10px;top: 5px;cursor: pointer;z-index: 2;}


      /* 產品展示 */
      .image-container {width: 100%;text-align: center;}
      .responsive-image {max-width: 100%;height: auto;}
      @media (min-width: 768px) {.responsive-image , .輪播圖, .image-container iframe{  height: auto;  width: 50%;max-width: 760px;}}
      
      .image-container iframe{height: auto;min-height: 300px;}
      .company-intro {width: 90%;max-width: 760px;margin: 20px auto;padding: 20px;line-height: 2;text-align: center;}
      .contact-section {width: auto;margin: 0 2% ;padding: 20px;line-height: 2;}
      .contact-title {font-size: 24px;height: 50px;display: flex;justify-content: space-between;align-items: center;}
      .toggle-btn {cursor: pointer;font-size: 24px;}
      .contact-content {height: 0;overflow: hidden;transition: height 0.3s ease-in-out;}

      /* 輪播圖 */
      .輪播圖 {position: relative;overflow: hidden;border: 2px solid #ccc;border-radius: 10px;margin: auto;}
      .輪播圖-images {display: flex;transition: transform 0.5s ease-in-out;width: 100%;}
      .輪播圖-images img {object-fit: cover;width: 100%;height: auto;}
      .輪播圖 button {position: absolute;top: 50%;transform: translateY(-50%);background-color: rgba(0, 0, 0, 0);border:none; cursor: pointer;z-index: 10;width: 40%;height: 80%;}
      .輪播圖 button.prev {left: 0px;}
      .輪播圖 button.next {right: 0px;}


      /* line圖示 */
      .social-links {margin: 20px ;}
      .line-icon {width: 40px;height: 40px;}
      .line-icon:hover > path{fill: #00B900;}

      .copyright {text-align: center;padding: 20px;background: #f8f8f8;}
      
      @keyframes scrollUp {0% { transform: translateY(100%); }
        100% { transform: translateY(-100%); }
      }

      
      /* admin */
      .btn {border: none; padding: 10px 20px; cursor: pointer; border-radius: 5px; margin-top: 10px; width: auto; text-align: center;}
      .section,nav,#AdminSet { display: none;}
      nav{padding: 1%;z-index: 99;}
      .active { display: block;}
      .container {max-width: 760px;margin: 2rem auto;padding: 0 1rem;}
    
      h1,h2,h3,label {display: block;margin-bottom: 0.5rem;color: var(--主題色); }
      input, select, textarea,button {width: 98%;padding: 0.8rem;border: 1px solid #ddd;border-radius: 5px;font-size: 1rem;margin: 1%;}

      ._更新btn{background: var(--主題色);}


      .toggle-營業狀態開關 {position: relative;margin: 2%;width: 84px;height: 50px;text-align: center;font-size: 20px;line-height: 40px;}
      /* 隱藏原始 checkbox */
      .toggle-營業狀態開關 input {opacity: 0;width: 0;height: 0;}
      /* 滑動條樣式 */
      .slider {position: absolute;cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;border-radius: 25px;transition: background-color 0.4s;}
      /* 滑動按鈕樣式 */
      .slider::before {position: absolute;content: "";height: 42px;width: 42px;left: -1px;background-color: #888;border-radius: 42px;transition: transform 0.4s;}
      /* 選擇 On 狀態的樣式 */
      input:checked + .slider {background-color: #5d53e2;}
      input:checked + .slider::before {transform: translateX(43px);}
      button.delete {background-color: #f44336;}
    </style>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js">// 加密/解密處理</script>

    <script src="https://clymene15093.github.io/data/a.js"></script>

  </head>
<body>
  <samp id="更新約需5分鐘" class="none">更新約需5分鐘，請耐心等待。</samp>











<!--
/* $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

      :::::::::       ::::::::       :::::::::    :::   :::
     :+:    :+:     :+:    :+:      :+:    :+:   :+:   :+:
    +:+    +:+     +:+    +:+      +:+    +:+    +:+ +:+
   +#++:++#+      +#+    +:+      +#+    +:+     +#++:
  +#+    +#+     +#+    +#+      +#+    +#+      +#+
 #+#    #+#     #+#    #+#      #+#    #+#      #+#
#########       ########       #########       ###

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */
-->
















<section id="主頁page" class="section active">
  <div class="logo-container">
    <div class="logo"><img id="logo" alt="誠鑫搬家"></div>
  </div>
  <div class="marquee-container" id="marqueeContainer">
    <!--<div class="close-marquee" onclick="closeMarquee()">×</div>-->
    <div id="走馬燈" class="marquee-content"><!-- JS 走馬燈內容 --></div>
  </div>
  <div id="產品展示" style="margin-top: 60px;"><!-- JS 產品展示內容 --></div>
  <div id="關於我們" class="company-intro"><!-- JS 關於我們內容 --></div>
  <div class="contact-section">
    <div class="contact-title">
      客服與聯絡資訊
      <span class="toggle-btn" onclick="toggleContact()">+</span>
    </div>
    <div id="聯絡資訊" class="contact-content" ><!-- JS 聯絡資訊內容 --></div>
  </div>
  <div id="社交帳號"  class="social-links ContactAKI"><!-- JS 社交帳號內容 --></div>
  <div class="copyright"></div>
  <div class="scroll-top" id="scrollTop" onclick="scrollToTop()">↑</div>




</section>

















<section id="產品展示page" class="section">
  <div class="container">
    <h2>產品展示</h2>
    yt影片 = Share > Embed > 貼在展示內容<br>
    輪播圖 = 展示內容 > 圖1ulr,圖2ulr,圖3ulr...


    <div id="產品展示input">
      <div id="產i0">
        <input type="text" placeholder="請輸入產品圖片" title="請輸入產品圖片" >
        <input type="text" placeholder="請輸入產品的連結" title="請輸入產品的連結">
        <button class="btn delete" onclick="刪除Input('產i0')">刪除</button>
        <hr>
      </div>
      
    </div>
    <button class="btn" onclick="增加Input('產品展示')" >新增產品圖片</button>
  </div>
  
</section>















<section id="走馬關於page" class="section">
  <div class="container">
    <h2>關於我們</h2>
    <textarea id="關於我們字Input" placeholder="請修改您的關於我們" title="請修改您的關於我們" ></textarea>
    <hr><br>
    <h2>走馬燈內容</h2>
    <div id="走馬燈input">
      <div id="走i0">
        <input type="text" placeholder="請輸入走馬燈內容" title="請輸入走馬燈內容" >
        <input type="text" placeholder="請輸入走馬燈的連結" title="請輸入走馬燈的連結">
        <button class="btn delete" onclick="刪除Input('走i0')">刪除</button>
        <hr>
      </div>
    </div>
    <button class="btn" onclick="增加Input('走馬燈')" >新增走馬燈內容</button>
  </div>
</section>













<section id="聯絡資訊page" class="section">
  <div class="container">
    <h2>聯絡資訊</h2>
    <textarea id="聯絡資訊htmlInput" placeholder="請修改您的聯絡資訊" title="請修改您的聯絡資訊" ></textarea>
        <hr>
    <h2>社交帳號</h2>
    <textarea id="社交帳號htmlInput" placeholder="請修改您的社交帳號" title="請修改您的社交帳號" ></textarea>
  </div>
</section>













<section id="公司資料page" class="section">
  <div class="container">
    <h2>管理員密碼</h2>
    <input type="text" id="管理員密碼OUT" placeholder="請填寫您現在的管理員密碼" title="請填寫您現在的管理員密碼" >
    <input type="password" id="管理員密碼Input" placeholder="請修改您新的的管理員密碼" title="請修改您新的的管理員密碼" >
    <input type="password" id="管理員密碼BBB" placeholder="請重複輸入您新的的管理員密碼" title="請重複輸入您新的的管理員密碼" >
    <h2>營業狀態</h2>
    <div class="toggle-營業狀態開關">
      <input type="checkbox" id="營業狀態開關" />
      <label for="營業狀態開關" class="slider">on      off</label>
    </div>
    <h2>Google Tag Manager code1</h2>
    <textarea id="GTM1Input" placeholder="請修改您的GTM1" title="請修改您的GTM1" ></textarea>
    <h2>Google Tag Manager code2</h2>
    <textarea id="GTM2Input" placeholder="請修改您的GTM2" title="請修改您的GTM2" ></textarea>
    <h2>Google Search Console code</h2>
    <textarea id="GSCInput" placeholder="請修改您的GSC" title="請修改您的GSC" ></textarea>
    <hr><br>
    <h2>公司名稱</h2>
    <input type="text" id="公司名Input" placeholder="請修改您的公司名稱" title="請修改您的公司名稱" >
    <h2>公司標題</h2>
    <input type="text" id="公司標題Input" placeholder="請修改您的公司標題" title="請修改您的公司標題" >
    <h2>公司簡介</h2>
    <input type="text" id="公司簡介Input" placeholder="請修改您的公司簡介" title="請修改您的公司簡介" >
    <h2>LOGO圖片</h2>
    <input type="text" id="LOGO圖片Input" placeholder="請修改您的LOGO圖片" title="請修改您的LOGO圖片" >
    <h2>分頁圖示</h2>
    <input type="text" id="分頁圖示Input" placeholder="請修改您的分頁圖示" title="請修改您的分頁圖示" >
    <h2>社群封面</h2>
    <input type="text" id="社群封面Input" placeholder="請修改您的社群封面" title="請修改您的社群封面" >
    <hr><br>
    <a href="https://codepen.io/98672794/pen/yLwQzjd" target="_blank" ><i class="fa fa-paint-brush" aria-hidden="true"></i></a>
    <h2>主題色</h2>
    <input type="text" id="主題色Input" placeholder="請修改您的主題色" title="請修改您的主題色" >
    <h2>走馬燈文字色</h2>
    <input type="text" id="走馬燈文字色Input" placeholder="請修改您的走馬燈文字色" title="請修改您的走馬燈文字色" >
  </div>
</section>







<nav style="text-align: center;">
  <button class="btn" id="主頁btn" onclick="_導航換頁('主頁')" >主頁</button>
  <button class="btn" id="產品展示btn" onclick="_導航換頁('產品展示')" >產品展示</button>
  <button class="btn" id="走馬關於btn" onclick="_導航換頁('走馬關於')" >走馬燈/關於我們</button>
  <button class="btn" id="聯絡資訊btn" onclick="_導航換頁('聯絡資訊')" >聯絡資訊</button>
  <button class="btn" id="公司資料btn" onclick="_導航換頁('公司資料')" >公司資料</button>

  <button class=" _更新btn btn" onclick="_更新all野()" >更新資料</button>
</nav>



















    <script>

      /* $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

            ::::::::       ::::::::       ::::::::
          :+:    :+:     :+:    :+:     :+:    :+:
        +:+            +:+            +:+
        +#+            +#++:++#++     +#++:++#++
      +#+                   +#+            +#+
      #+#    #+#     #+#    #+#     #+#    #+#
      ########       ########       ########

      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */




      // 關走馬燈
      function closeMarquee() {
        document.getElementById('marqueeContainer').style.display = 'none';
      }


      function _走馬燈動() {
        const $content = $('.marquee-content');
        const $items = $('.marquee-item');
        const itemHeight = $items.outerHeight();
        const itemCount = $items.length;
        let currentIndex = 0;
        function scrollMarquee() {
          currentIndex++;
          if (currentIndex >= itemCount) {
            // 到最後一條後立即回到第一條
            $content.css('transform', `translateY(0)`);
            currentIndex = 0; // 重置索引
          } else {
            // 滾動到下一條
            $content.css('transform', `translateY(-${itemHeight * currentIndex}px)`);
          }
        }
        // 每次滾動後停留一秒
        setInterval(scrollMarquee, 1500); // 包括滑動與停留時間
      }


      // 開闢 聯絡卡
      function toggleContact() {
        const content = document.getElementById('聯絡資訊');
        const btn = document.querySelector('.toggle-btn');
        if (content.style.height === '0px' || content.style.height === '') {
          // 開啟
          content.style.height = 'auto';
          const height = content.offsetHeight + 'px'; // 取得實際高度
          content.style.height = '0px'; // 先設定為 0 以便觸發過渡
          setTimeout(() => {
            content.style.height = height; // 再設定為實際高度
          }, 0);
          btn.textContent = '-';
        } else {
          // 關閉
          content.style.height = content.offsetHeight + 'px'; // 設定為當前高度以觸發過渡
          setTimeout(() => {
            content.style.height = '0px'; // 再設定為 0
          }, 0);
          btn.textContent = '+';
        }
      }





      // 輪播圖
      function _輪播圖動() {
          const images = document.querySelector('.輪播圖-images');
          const prevButton = document.querySelector('.prev');
          const nextButton = document.querySelector('.next');
          let currentIndex = 0;
          const imageCount = images.children.length;
          function updateCarousel() {
              const containerWidth = images.parentElement.clientWidth; // 獲取容器寬度
              const offset = -currentIndex * containerWidth;
              images.style.transform = `translateX(${offset}px)`;
          }
          prevButton.addEventListener('click', () => {
              currentIndex = (currentIndex - 1 + imageCount) % imageCount;
              updateCarousel();
          });
          nextButton.addEventListener('click', () => {
              currentIndex = (currentIndex + 1) % imageCount;
              updateCarousel();
          });
          // 自動播放功能
          setInterval(() => {
              currentIndex = (currentIndex + 1) % imageCount;
              updateCarousel();
          }, 3000); // 每 3 秒切換一次
          // 初始化輪播圖位置
          updateCarousel();
          // 當窗口大小改變時，更新輪播圖位置
          window.addEventListener('resize', updateCarousel);
      }














      /* $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

            :::::::::           :::    :::::::::::           :::
          :+:    :+:        :+: :+:      :+:             :+: :+:
          +:+    +:+       +:+   +:+     +:+            +:+   +:+
        +#+    +:+      +#++:++#++:    +#+           +#++:++#++:
        +#+    +#+      +#+     +#+    +#+           +#+     +#+
      #+#    #+#      #+#     #+#    #+#           #+#     #+#
      #########       ###     ###    ###           ###     ###

      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */



      let 產品展示 = [
        {'產品展示圖': '001.webp', '產品展示url': ''},
        { '產品展示圖': '<iframe width="560" height="315" src="https://www.youtube.com/embed/NNV7EYAsIpI?si=QD1uL88OtuHhGm0Z" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>', '產品展示url': '' },
        
        {'產品展示圖': '001.webp,002.webp', '產品展示url': 'https://lin.ee/exeQ2Yx,https://lin.ee/exeQ2Yx'},
        
        {'產品展示圖': '002.webp', '產品展示url': 'https://lin.ee/exeQ2Yx'},
        {'產品展示圖': '003.webp', '產品展示url': 'https://lin.ee/416xnF3'}
      ];


      

      
      let 走馬燈 = [
        {'走馬燈字': '🌟 加LINE立即領取500元搬家優惠金 ✨', '走馬燈url': 'https://lin.ee/exeQ2Yx'},
        {'走馬燈字': '🌟 點這裡！即可快速加LINE使用最高優惠 ✨', '走馬燈url': 'https://lin.ee/exeQ2Yx'}
      ];
      
      let 關於我們 = [
        {'關於我們字':`
        誠鑫搬家<br>各式各樣大型小型及整層搬家皆可<br>小資學生女性套房搬遷首選！<br>
        小資學生女性套房搬遷<br>免動手代客精緻打包<br>超重型、特殊物品搬遷<br>
        鋼琴搬運、古董家具搬運<br>吊車服務、廢棄物清運、居家清潔等<br>
        我們全都可以一條龍幫你服務到家！<br>加LINE發問即可享有免費線上估價！`}
      ];

      let 聯絡資訊 = [
        {'聯絡資訊html':`LINE ID：<a href="https://line.me/R/ti/p/@457ffejd" target="_blank" rel="noreferrer noopener">@457ffejd</a><br>營業時間：週一 至 週日｜08:00 – 23:00`}];
        
        let 社交帳號 = [
        {'社交帳號html': `<a href="https://line.me/ti/p/@example"><i class="lineB"></i></a>`}
      ];


      let 公司資料 = [
        { 
          '營業狀態':'true',
          '管理員密碼':'7dda0cabd1fdf46e34f8cac123db4471addc49761b6a2a48184ed824d614cad0',
          '公司名': '誠鑫搬家',
          '公司標題': `r精緻型專業搬遷、廠房辦公室搬運最優解｜誠鑫搬家｜北部地區首選、台北市、新北市、桃園市、基隆市`,
          '公司簡介':'各式各樣大型小型及整層搬家皆可，小資學生女性套房搬遷首選！免動手代客精緻打包、超重型、特殊物品搬遷、鋼琴搬運、古董家具搬運、吊車服務、廢棄物清運、居家清潔等，誠鑫搬家全都可以一條龍幫你服務到家！加LINE發問即可享有免費線上估價！',
          'LOGO圖片':'01-頁首LOGO.png',
          '分頁圖示':'02-Favicon分頁圖示.png',
          '社群封面':'https://gs.liteshop.tw/public/meta_og_image/4cFJZCxH9xndRKyC9YEHDDWy/06-社群封面-1200x630(2).webp',
          '主題色':'#54d6f4',
          '走馬燈文字色':'#edff66',
          'GTM1':'',
          'GTM2':'',
          'GSC':'',
        }
      ];




















/* $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      :::::::::           :::        ::::::::       ::::::::::
     :+:    :+:        :+: :+:     :+:    :+:      :+:
    +:+    +:+       +:+   +:+    +:+             +:+
   +#++:++#+       +#++:++#++:   :#:             +#++:++#
  +#+             +#+     +#+   +#+   +#+#      +#+
 #+#             #+#     #+#   #+#    #+#      #+#
###             ###     ###    ########       ##########

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */

      // 顯示內容
      async function _顯示內容(sel) {
        let 內容data = eval(sel);

        if (sel == '公司資料'){
            // 初始營業狀態
            const 開關 = $('#營業狀態開關');
            // 設定預設狀態
            if (營業狀態) {
              開關.prop('checked', true);
              //console.log(`預設狀態：開啟`);
            } else {
              開關.prop('checked', false);
              //console.log(`預設狀態：關閉`);
            }
            // 綁定開關狀態改變事件
            開關.change(function () {
              if ($(this).is(':checked')) {
                營業狀態 = true;
                //console.log(`開關已開啟=${營業狀態}`);
              } else {
                營業狀態 = false;
                //console.log(`開關已關閉=${營業狀態}`);
              }
            });

            // Google工具
            // GTM
            $("head").append(_特別字處理(內容data[0].GTM1));
            $('#GTM1Input').val(_特別字處理(內容data[0].GTM1));
          
            $("body").prepend(內容data[0].GTM2);
            $('#GTM2Input').val(內容data[0].GTM2);

            // GSC 
            $("head").append(內容data[0].GSC);
            $('#GSCInput').val(內容data[0].GSC);
            
            // 公司名
            $('meta[property="og:site_name"]').attr("content", 內容data[0].公司名);
            $('meta[name="copyright"]').attr("content", 內容data[0].公司名);
            $('.copyright').text(`© ${new Date().getFullYear()} All rights reserved by ${內容data[0].公司名}`)
            $('#公司名Input').val(內容data[0].公司名);

            // 公司標題
            $("title").text(內容data[0].公司標題);
            $('meta[property="og:title"]').attr("content", 內容data[0].公司標題);
            $('meta[property="og:image:alt"]').attr("content", 內容data[0].公司標題);
            $('#公司標題Input').val(內容data[0].公司標題);

            // 公司簡介
            $('meta[property="og:description"]').attr("content", 內容data[0].公司簡介);
            $('meta[name="description"]').attr("content", 內容data[0].公司簡介);
            $('#公司簡介Input').val(內容data[0].公司簡介);

            // LOGO圖片
            $("#logo").attr("src", 內容data[0].LOGO圖片)
            // 檢查是否已存在 <link rel="icon">
            let $favicon = $("link[rel='icon'], link[rel='shortcut icon'], link[rel='alternate icon'], link[rel='apple-touch-icon']");
            $('#LOGO圖片Input').val(內容data[0].LOGO圖片);

            // 分頁圖示
            if ($favicon.length) {
                // 替換現有的分頁圖示
                $favicon.attr("href", 內容data[0].分頁圖示).attr("type", "image/x-icon");
            } else {
                // 如果不存在，新增 <link rel="icon">
                $("head").append(
                    `<link rel="icon" type="image/x-icon" href="${內容data[0].分頁圖示}">`
                );
            }
            $('#分頁圖示Input').val(內容data[0].分頁圖示);
            
            // 社群封面
            $('meta[property="og:image"]').attr("content", 內容data[0].社群封面);
            $('meta[property="og:image:secure_url"]').attr("content", 內容data[0].社群封面);
            $('#社群封面Input').val(內容data[0].社群封面);

            // css
            document.documentElement.style.setProperty("--主題色", 內容data[0].主題色);
            $('#主題色Input').val(內容data[0].主題色);
            document.documentElement.style.setProperty("--走馬燈文字色", 內容data[0].走馬燈文字色);
            $('#走馬燈文字色Input').val(內容data[0].走馬燈文字色);
        }


        let cont = 0;
        for (let 內容 of 內容data){
          let 單個內容, all內容



          /***************** 走馬燈 ******************/
          if (sel == '走馬燈') {
            all內容 = `<div class="marquee-item"><a href="${內容.走馬燈url}" target="_blank" rel="noopener noreferrer">${內容.走馬燈字}</a></div>`;
            $(`#走馬燈input div`).eq(cont).find("input").eq(0).val(內容.走馬燈字);
            $(`#走馬燈input div`).eq(cont).find("input").eq(1).val(內容.走馬燈url); 
            增加Input('走馬燈')
          }
          




          /***************** 產品展示 ******************/
          if (sel == '產品展示'){
            // 只圖
            $內容圖 = $(`<img class="responsive-image" src="${內容.產品展示圖}" >`);
            單個內容 = $內容圖
            // 有ulr圖
            if (內容.產品展示url != '') 單個內容 = $(`<a href="${內容.產品展示url}" target="_blank"></a>`).append($內容圖); // 包裹連結並插入圖片
            // yt片
            /*
            if (內容.產品展示圖.includes('iframe')) {
              整尺寸 = 內容.產品展示圖.split('src')[1]
              整尺寸 =  '<iframe width="100%" height="auto" src' + 整尺寸
              單個內容 = 整尺寸; // 直接插入yt片
              }
            */
            if (內容.產品展示圖.includes('<iframe')) { 
              單個內容 = 內容.產品展示圖.replace(/width="[^"]+"/, 'width="100%"');
            }


            // 輪播圖
            if (內容.產品展示圖.includes(',')){
              // 取輪播料
              整組輪播圖 = 內容.產品展示圖.split(',')
              $輪播圖容器 = $('<div class="輪播圖-images"></div>');

              for (let i = 0; i < 整組輪播圖.length; i++) {
                $輪圖 = $(`<img class="responsive-image" src="${整組輪播圖[i]}" >`);
                第n輪圖 = $輪圖;
                // a 有問題不做
                $輪播圖容器.append(第n輪圖);
              }
              單個內容 = $('<div class="輪播圖"><button class="prev"></button><button class="next"></button></div>').append($輪播圖容器);
            }

            all內容 = $(`<div class="image-container"></div>`).append(單個內容); // 包裹圖片容器
            // 加載錯誤時隱藏該圖片
            $內容圖.on("error", function () {
              if (!/<iframe|,/.test(內容.產品展示圖)) all內容.remove(); // 移除整個容器
            });

            // admin
            $(`#產品展示input div`).eq(cont).find("input").eq(0).val(內容.產品展示圖);
            $(`#產品展示input div`).eq(cont).find("input").eq(1).val(內容.產品展示url);
            增加Input('產品展示')
          }




          /***************** 關於我們 ******************/
          if (sel == '關於我們') {
            all內容 = `<p>${內容.關於我們字}</p>`;
            $('#關於我們字Input').val(內容.關於我們字);
          }
          





          /***************** 聯絡資訊 ******************/
          if (sel == '聯絡資訊') {
            all內容 = 內容.聯絡資訊html;
            $('#聯絡資訊htmlInput').val(內容.聯絡資訊html);
          }






          /***************** 社交帳號 ******************/
          if (sel == '社交帳號') {
            all內容 = 內容.社交帳號html;
            $('#社交帳號htmlInput').val(內容.社交帳號html);
          }

          // 加入DOM
          $(`#${sel}`).append(all內容);
          cont+=1
        }
      }






      












/* $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
          :::        :::::::::         :::   :::       :::::::::::       ::::    :::
       :+: :+:      :+:    :+:       :+:+: :+:+:          :+:           :+:+:   :+:
     +:+   +:+     +:+    +:+      +:+ +:+:+ +:+         +:+           :+:+:+  +:+
   +#++:++#++:    +#+    +:+      +#+  +:+  +#+         +#+           +#+ +:+ +#+
  +#+     +#+    +#+    +#+      +#+       +#+         +#+           +#+  +#+#+#
 #+#     #+#    #+#    #+#      #+#       #+#         #+#           #+#   #+#+#
###     ###    #########       ###       ###     ###########       ###    ####

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */





      function _去後台(AdminPW) {
        admin明文 = false;
        if ((location.href).indexOf('???') != -1) admin明文 = decodeURIComponent(location.href.split('???')[1])
        if (sha256(admin明文) == AdminPW) {
          $('nav').addClass('active');
          $("body").css("background-color", "#000");
        }
      };





      function _導航換頁(page) {
        // 隱頁 - .active
        $('.section').removeClass('active');
        // 顯頁 + .active
        $(`#${page}page`).addClass('active');
      };





      // 增加Input
      let 產計 = 1, 走計 = 1;
      function 增加Input(類型) {
        let id前綴 = '產i',
            I_cont   = 產計;
        if (類型 == '走馬燈') {id前綴 = '走i'; I_cont = 走計;}

        $(`#${類型}input`).append(`
          <div id="${id前綴}${I_cont}">
            <input type="text" placeholder="請輸入${類型}內容" title="請輸入${類型}內容" >
            <input type="text" placeholder="請輸入${類型}的連結" title="請輸入${類型}的連結">
            <button class="btn delete" onclick="刪除Input('${id前綴}${I_cont}')">刪除</button>
            <hr>
          </div>
        `)

        I_cont+=1
        if (類型 == '產品展示') 產計 = I_cont;
        if (類型 == '走馬燈') 走計 = I_cont;
      };



      function 刪除Input(id) {
        $(`#${id}`).remove();
      }



      function _取Input(id) { 
        const inputs = document.querySelectorAll(`#${id}input div input`);
        let 整合多條數據 = `${數據分隔符}${id}${數據分隔符B}[`
          , 展示類型 = '圖';
        if (id == '走馬燈') 展示類型 = '字';

        // 將內容組合為指定的格式
        inputs.forEach((input, index) => {
          if (index % 2 === 0) {
            // (index 為偶數)，為產品展示圖
            整合多條數據 += `{'${id}${展示類型}': '${input.value}', `;
          } else {
            // (index 為奇數)，為產品展示url，並結尾
            整合多條數據 += `'${id}url': '${input.value}'},\n`;
          }
        });

        整合多條數據 += "];"; // 結尾補上陣列符號
        //console.log(整合多條數據);
        return 整合多條數據;
      }





      function _驗管理員密碼() {
        let OVG256 = 公司資料[0].管理員密碼
        
          , 原密碼輸入256 = sha256($('#管理員密碼OUT').val())

          , 新密碼明文 = $('#管理員密碼Input').val()
          , 新密碼256 = sha256(新密碼明文)
          , 確認新密碼256 = sha256($('#管理員密碼BBB').val());

        if (!新密碼明文) return OVG256; // 新密碼為空
        if (原密碼輸入256 !== OVG256) return OVG256; // 原密碼錯
        if (新密碼256 !== 確認新密碼256) return OVG256; // 新密碼不一致

        return 新密碼256;
      }




      function _特別字處理(文字) {
          文字 = 文字.replace(/script/g, '哩咖食友朋'); // 精確匹配完整的 "script"
          文字 = 文字.replace(/哩咖食友朋/g, 'script'); // 精確匹配完整的 "哩咖食友朋"
          文字 = 文字.replace(/'/g,'"').replace(/<br>/g,'')
          return 文字;
      }







      const 數據分隔符 = '\n$%$';
      const 數據分隔符B = '#$#$';
      function _更新all資料(數據id, data位) {
        // up新數據
        let 新data , data內id, all新數據, 數據的val;
        新data = []
        data內id = [] 
        for (data of data位) {
          data內id.push(data.split('Input')[0]) // 存每個data的id

          數據的val = $(`#${data}`).val().replace(/\n/g,"<br>");
          if (data == '管理員密碼Input') 數據的val = _驗管理員密碼();
          if (data == 'GTM1Input' || data == 'GTM2Input' || data == 'GSCInput') 數據的val = _特別字處理(數據的val);


          新data.push(數據的val) // 存每個data
        }

        //營業狀態
        if (數據id == '公司資料'){
          新data.push(營業狀態) ;
          data內id.push('營業狀態');
        }

        // 組合所有新數據
        all新數據 = `${數據分隔符}${數據id}${數據分隔符B}[{`;
        // 確保每個 id 對應一個值
        for (let i = 0; i < data內id.length; i++) {
          all新數據 += `${data內id[i]}:'${新data[i]}',`;
        }
        // 去除最後多餘的逗號並補上結尾括號
        all新數據 = all新數據.slice(0, -1) + `}];`;

        //console.log(`all公司資料=${all新數據}!!!`);
        return all新數據;
      }







      function _更新all野() {
        let 公司資料 = _更新all資料(
          '公司資料', ['管理員密碼Input', 'GTM1Input', 'GTM2Input', 'GSCInput', '公司名Input', '公司標題Input', '公司簡介Input', 'LOGO圖片Input', '分頁圖示Input', '社群封面Input', '主題色Input', '走馬燈文字色Input']
        )
        , 聯絡資訊 = _更新all資料('聯絡資訊', ['聯絡資訊htmlInput'])
        , 社交帳號 = _更新all資料('社交帳號', ['社交帳號htmlInput'])
        , 關於我們 = _更新all資料('關於我們', ['關於我們字Input'])
        , 產品展示 = _取Input('產品展示')
        , 走馬燈   = _取Input('走馬燈')
        , 所有資料 = 公司資料 + 聯絡資訊 + 社交帳號 + 關於我們 + 產品展示 + 走馬燈;
        //console.log(`所有資料=${所有資料}!!!`);
        alert('更新約需5分鐘，請耐心等待。');
        _更新數據B(各網, 所有資料, cut文件前綴,gh帳名, 庫名, token)
      }






      






























/* $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      ::::::::   :::::::::::           :::        :::::::::   :::::::::::
    :+:    :+:      :+:             :+: :+:      :+:    :+:      :+:
   +:+             +:+            +:+   +:+     +:+    +:+      +:+
  +#++:++#++      +#+           +#++:++#++:    +#++:++#:       +#+
        +#+      +#+           +#+     +#+    +#+    +#+      +#+
#+#    #+#      #+#           #+#     #+#    #+#    #+#      #+#
########       ###           ###     ###    ###    ###      ###
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */





  const gh帳名 = 'clymene15093',
        庫名 = 'data', // aa/bb/cc
        cut文件前綴 = `.io/${庫名}/`
        帳號數據庫 = `https://${gh帳名}.github${cut文件前綴}data222`,
        token="\u0067\u0069\u0074\u0068\u0075\u0062\u005F\u0070\u0061\u0074\u005F\u0031\u0031\u0042\u0043\u004D\u0054\u004B\u0034\u0041\u0030\u0065\u0058\u0044\u0050\u004F\u0048\u006C\u0038\u0068\u0032\u0061\u0079\u005F\u0076\u0061\u0045\u0033\u0059\u005A\u0053\u004F\u0078\u0056\u006A\u0056\u006C\u0044\u0038\u006C\u0054\u004B\u0033\u0071\u0041\u0043\u0056\u006B\u0031\u0032\u006D\u0058\u0069\u0044\u006B\u004F\u0071\u0051\u0067\u005A\u0030\u0075\u0078\u006B\u0048\u0050\u0059\u004B\u004C\u0046\u0054\u0056\u004A\u0043\u0032\u0072\u0077\u0064\u0059\u0051\u0045\u0042\u006B", // updata

        各網 = decodeURIComponent(location.href).split('.github.io/')[1].split('.html')[0].replace('/','');



  let 營業狀態;

  async function Start() {

    $("body").css("margin-top", "0px");
    $(".logo-container").css("margin-top", "0px");
    //console.log(`各網=${各網}!!!`);
    //console.log(`帳號數據庫=${帳號數據庫}!!!`);

    if (await _0xdv("\u5BB6\u642C\u946B\u8AA0"['\u0073\u0070\u006C\u0069\u0074']("")['\u0072\u0065\u0076\u0065\u0072\u0073\u0065']()['\u006A\u006F\u0069\u006E']("")) === false) return;

    // 取數據庫內容
    let Alldata = await _取本頁數據庫(各網, 'Alldata','html碼');

    if (Alldata){
      //console.log(`Alldata0==`,Alldata);
      Alldata = Alldata.split(數據分隔符);  // 折分數據
      //console.log(`Alldata1==`,Alldata);

      公司資料 = eval(Alldata[1].split(數據分隔符B)[1])
      聯絡資訊 = eval(Alldata[2].split(數據分隔符B)[1])
      社交帳號 = eval(Alldata[3].split(數據分隔符B)[1])
      關於我們 = eval(Alldata[4].split(數據分隔符B)[1])
      產品展示 = eval(Alldata[5].split(數據分隔符B)[1])
      走馬燈   = eval(Alldata[6].split(數據分隔符B)[1])

      //console.log(`公司資料==`,公司資料);
      //console.log(`聯絡資訊==`,聯絡資訊);
      //console.log(`社交帳號==`,社交帳號);
      //console.log(`關於我們==`,關於我們);
      //console.log(`產品展示==`,產品展示);
      //console.log(`走馬燈==`,走馬燈);
    }

    _去後台(公司資料[0].管理員密碼)

    營業狀態 = eval(公司資料[0].營業狀態)
    if (!營業狀態) return;

    // 顯示內容
    ['公司資料',  '關於我們', '聯絡資訊', '社交帳號'].forEach(_顯示內容);
    _顯示內容('走馬燈').then(_走馬燈動);
    _顯示內容('產品展示').then(_輪播圖動);
        
        
  }













  
  琪琪修改('../../')
    </script>
  </body>
</html>
